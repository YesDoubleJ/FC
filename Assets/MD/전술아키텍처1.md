# 로또축구단 매치 엔진 전술 시스템 확장 및 아키텍처 설계 보고서

## 1. 서론: 통계적 결정론 기반 3D 매치 엔진의 철학과 스케일업 방향

현대 축구 시뮬레이션 게임 개발에 있어 가장 큰 난제 중 하나는 아케이드
장르 특유의 인위적인 조작감을 배제하고, 선수의 능력치(Stats)와 물리
연산(Physics)이 실시간으로 상호작용하여 결과를 도출하는 환경을 구축하는
것이다. \'로또축구단\' 프로젝트의 매치 엔진은 이러한 인위성을 극복하기
위해 유니티(Unity) 엔진의 NVIDIA PhysX를 활용한 완전한 3차원 탄도학(True
3D Ballistics)과 능력치 기반의 통계적 결정론(Statistical Determinism)을
융합하는 철학을 근간으로 삼고 있다.^1^ 현재 시스템은 6v6 스몰 사이드
게임(Small-Sided Game) 규격에 맞추어 설계되었으나, 프로젝트의 궁극적인
목표인 정규 축구 규격(11v11)으로 확장하기 위해서는 단순한
에이전트(Agent) 수의 증가를 넘어선 근본적인 아키텍처의 혁신이 요구된다.

현재 매치 엔진의 아키텍처는 단일 클래스가 모든 연산을 책임지는 거대
클래스(God Class)의 출현을 방지하기 위해 철저한 컴포넌트 기반
구조(Component-Based Architecture)를 채택하고 있다.^1^ 에이전트의 논리적
실행을 총괄하는 HybridAgentController를 중심으로, 이동과 경로 탐색을
담당하는 AgentMover, 물리 엔진과의 충돌 및 공 소유권을 제어하는
AgentBallHandler, 그리고 스킬을 시전하는 AgentSkillSystem으로 책임이
철저히 분리되어 있다.^1^ 더불어 AI의 두뇌 역할을 하는 의사결정 레이어는
계층적 유한 상태 머신(HFSM)을 통해 공격, 수비, 전환이라는 거시적
문맥(Context)을 통제하고, 그 하위에서 유틸리티 AI(Utility AI) 기반의
DecisionEvaluator가 슈팅, 패스, 드리블 등 미시적 행동(Micro-Action)의
가치를 수학적으로 산출하여 최적의 선택을 내리도록 설계되어 있다.^1^

그러나 8v8을 거쳐 11v11로 스케일업(Scale-up)하는 과정에서는 피치 위의
공간 밀도가 급격히 상승하며, 선수 간의 물리적 상호작용 및
오프더볼(Off-the-ball) 움직임의 복잡도가 기하급수적으로 증가한다. 특히
이 단계에서는 개별 선수의 지능적 판단을 넘어, 감독이 부여하는 \'전술적
지침(Tactical Instructions)\'이 시스템 전반에 수학적, 논리적으로
개입해야 한다.^1^ 팀 단위의 공격 폭, 템포, 수비 라인 높이, 압박 강도 등
글로벌 변수가 에이전트의 유틸리티 점수에 동적인 가중치로 작용해야 하며,
보로노이(Voronoi) 다이어그램이나 그리드(Grid) 기반의 공간 분할
알고리즘을 통해 22명의 에이전트가 충돌 없이 유기적인 포메이션을 유지하는
피치 제어(Pitch Control) 능력을 갖추어야 한다.^2^

본 보고서는 로또축구단 매치 엔진의 11v11 스케일업을 완벽히 지원하기 위한
종합적인 아키텍처 설계와 C# 구현 가이드를 제공한다. 전술 지침이 반영된
유틸리티 스코어링(Utility Scoring)의 수학적 모델링부터, 물리 법칙이
고려된 공간 제어 알고리즘, ScriptableObject를 활용한 데이터
주도형(Data-Driven) 전술 아키텍처, 그리고 대규모 에이전트 연산으로 인한
병목 현상을 방지하기 위한 유니티 잡 시스템(Job System) 및 비동기 타임
슬라이싱(Time-Slicing) 최적화 전략까지 심도 있게 분석하고 제안한다.

## 2. 전술 기반 유틸리티 스코어링 수학적 모델 설계

유틸리티 AI는 에이전트가 선택할 수 있는 다양한 행동 후보군에 대해
정규화된 점수(Normalized Score)를 부여하고, 이를 객관적으로 비교하여
현재 상황에서 가장 합리적인 행동을 도출하는 시스템이다.^4^ 현재 매치
엔진의 DecisionEvaluator는 공간 정보와 선수의 기본 능력치를 바탕으로
점수를 산출하고 있으나, 11v11 환경에서는 감독의 추상적인 전술 지침이 이
수학적 모델에 직접적인 가중치(Weight)로 곱해지거나 더해져야 한다.^1^

### 2.1 기존 의사결정 구조의 한계와 다차원 가중치 모델의 도입

기존 시스템에서 특정 행동의 점수 산출 공식은 환경적 요인(Factor)과
선수의 능력치(Weight)의 단순 선형 결합에 감독의 라이선스
보정치(LicenseModifier)를 곱하는 형태로 구성되어 있다.^1^

![](./images/media/image1.png){width="6.243082895888014in"
height="0.927603893263342in"}

이러한 선형적 접근 방식은 개별 선수의 상황 판단을 시뮬레이션하는 데는
무리가 없으나, \'템포 빠르게\'나 \'위험 감수\'와 같은 팀 단위의 전술적
압력이 개별 선수의 기본 성향을 덮어쓰거나 왜곡하는 현상을 구현하기에는
한계가 있다. 따라서 11v11 전술 시스템에서는 입력값을 비선형적으로
변환하는 반응 곡선(Response Curve)과 전술 지침에 의해
임계값(Threshold)이 동적으로 변화하는 다차원 가중치 모델을 도입해야
한다.^1^

반응 곡선 중 가장 널리 사용되는 로지스틱 함수(Logistic Function)나
시그모이드(Sigmoid) 곡선을 활용하면, 특정 조건(예: 골대와의 거리)에 따른
점수의 변화율을 정밀하게 제어할 수 있다.^5^ 전술 지침은 이 곡선의
기울기(Slope)나 중간점(Midpoint)을 이동시키는 매개변수로 작용하여,
감독이 공격적인 전술을 지시할 경우 거리가 멀더라도 슈팅을 시도할 확률이
기하급수적으로 높아지게 만든다.

### 2.2 팀 지침의 수학적 매핑 전략

감독이 지시하는 글로벌 팀 지침은 DecisionEvaluator가 계산하는 세부
팩터들에 곱해지는 전술적 승수(Tactical Multiplier)로 변환되어야 한다.
주요 전술 지침별 수학적 매핑 전략은 다음과 같다.

**템포(Tempo) 지침의 수학적 적용:** 경기 템포는 에이전트가 공을 소유했을
때 의사결정을 내리는 속도와 행동의 종류에 막대한 영향을 미친다. 템포가
\'빠르게\'로 설정된 경우, 시스템은 공을 오래 소유하는
\'드리블(Dribble)\'의 유틸리티 점수를 억제하고 \'원터치 패스(One-Touch
Pass)\' 또는 \'전진 패스(Forward Pass)\'의 기본 점수를 증폭시켜야
한다.^1^ 템포 지침을 정규화된 변수
![](./images/media/image2.png){width="1.109615048118985in"
height="0.24888560804899387in"} (1.0이 기본 템포)로 정의할 때, 각 행동의
가중치는 다음과 같이 재계산된다. 패스 팩터 보정:
![](./images/media/image4.png){width="4.743250218722659in"
height="0.2501935695538058in"} 드리블 팩터 보정:
![](./images/media/image13.png){width="3.2513024934383203in"
height="0.25010061242344706in"} 이러한 수식 적용을 통해 템포가 1.5에
도달하면 드리블의 가치가 절반으로 떨어지고 패스의 가치가 50% 상승하여,
팀 전체가 공을 빠르게 돌리는 티키타카(Tiki-Taka) 혹은 빠른 역습 형태의
플레이가 자연스럽게 창발(Emergent)된다.

**위험 감수(Risk-Taking) 및 패스 지향성 모델링:** 유틸리티 AI에서 패스
대상을 선택할 때, 기본적으로 \'안전도(Safety, 가중치 0.3)\'와
\'전진성(Progressiveness, 가중치 0.4)\'이 핵심 지표로 작용한다.^1^
\'위험 감수\' 지침은 이 고정된 가중치 비율을 동적으로 붕괴시킨다.
전술적으로 위험 감수 수치가 높아질수록, 패스 경로상에 수비수가 있어
차단될 확률이 존재하더라도 상대 골문과 가까워지는 스루패스의 점수가
급격히 상승해야 한다.^1^ 위험 감수 지수를 \$R \\in \[0.0, 1.0\]\$이라 할
때, 가중치 변환은 다음과 같이 이루어진다. 안전도 가중치:
![](./images/media/image3.png){width="2.3132294400699913in"
height="0.25007874015748033in"} (여기서
![](./images/media/image16.png){width="0.11149059492563429in"
height="0.24325240594925635in"}는 감쇠 상수) 전진성 가중치:
![](./images/media/image14.png){width="3.673666885389326in"
height="0.24976815398075242in"} 이 모델은 감독이 경기 막판 동점골을 위해
극단적인 공격을 지시할 때, 수비진의 롱패스나 무리한 전진 패스가 남발되는
실제 축구의 후반전 양상을 정확히 시뮬레이션한다.

**압박 강도(Pressing Intensity) 및 수비 라인 높이:** 수비 상황(Out of
Possession)에서 \'압박 강도\'는 HFSM의 상태 전이 임계값과
스티어링(Steering) 행동의 유틸리티에 관여한다. 압박 강도가 높을수록
DecisionEvaluator는 공을 가진 상대방을 향해 다가가는 \'Seek\' 행동의
가중치를 선형적으로 증가시킨다. 동시에 \'수비 라인 높이\' 지침은
포메이션 테더링(Tethering) 시스템의 기준점(Anchor Point) Z축 오프셋을
전방으로 이동시켜, 팀 전체의 블록이 상대 진영에 가깝게 형성되도록
유도한다.^1^ 단, 이 두 지침이 높게 설정될수록 물리 엔진 상에서
에이전트의 스프린트 빈도가 잦아지므로 체력(Stamina) 소모율이 가속화되는
인과 관계가 철저히 연동되어야 한다.^1^

### 2.3 규율 체크(Discipline Check)와 인간적 결함의 시뮬레이션

로또축구단 매치 엔진이 여타 아케이드 게임이나 완벽한 로직 기반의
시뮬레이터와 차별화되는 가장 큰 지점은, 에이전트가 감독의 지시를
무시하고 독단적인 판단을 내리는 \'인간적 결함(Human Flaws)\'을
시뮬레이션한다는 것이다.^1^ 이는 전술 지침이 완벽하더라도 선수의 상태에
따라 전술이 붕괴되는 현실성을 부여한다.

이 메커니즘은 실시간 능력치 보정 공식과 밀접하게 연동된다. 선수의
체력(![](./images/media/image9.png){width="0.77750656167979in"
height="0.2488024934383202in"})과
호흡(![](./images/media/image11.png){width="0.6438801399825022in"
height="0.24924431321084864in"})이 고갈되면 상태
지수(![](./images/media/image10.png){width="2.1615419947506562in"
height="0.27019247594050744in"})가 하락하며, 이에 비례하여 선수의 정신적
능력치인 \'집중력(Concentration)\'과 \'판단력(Judgment)\'이 저하된다.^1^
DecisionEvaluator는 최종 행동을 결정하기 직전, 다음과 같은 규율 체크
확률 수식을 실행한다.

![](./images/media/image5.png){width="6.243082895888014in"
height="0.5836603237095364in"}

매 프레임 생성되는
난수(![](./images/media/image18.png){width="1.3033016185476816in"
height="0.25023403324584426in"})가 이
![](./images/media/image12.png){width="0.7529286964129484in"
height="0.25097659667541555in"} 값을 초과하여 규율 체크에 실패할 경우,
에이전트는 계산된 전술 가중치를 1.0으로 초기화해버린다. 더 나아가,
선수가 가진 고유의 히든 특성(예: \'탐욕\', \'중거리 슛 선호\')에
기반하여 특정 행동의 최종 유틸리티 점수에 강제 부스트 계수(예:
![](./images/media/image7.png){width="2.3522080052493437in"
height="0.24979221347331584in"})를 적용한다.^1^ 이는 감독이 짧은 패스를
통한 안정적인 빌드업을 지시했음에도 불구하고, 체력이 고갈되어 집중력이
떨어진 선수가 골대 반경 30m 밖에서 무리한 중거리 슛을 시도하여 공격권을
헌납하는 상황을 통계적 결정론으로 훌륭하게 구현해낸다.^1^ 이러한 인간적
결함 로직은 감독 라이선스 등급이 낮을수록 발동 확률이 높아지도록
설계되어, 사용자에게 상위 라이선스 취득에 대한 강력한 동기를 부여한다.

## 3. 피치 공간 제어(Pitch Control) 알고리즘 및 오프더볼 위치 선정 설계

11v11 스케일업 환경에서 가장 복잡한 연산을 요구하는 부분은 공을 소유하지
않은 20명 이상의 선수들이 벌이는 오프더볼(Off-the-ball) 위치 선정이다.
단순한 추적(Seek)이나 회피(Flee) 기반의 조향 행동(Steering
Behaviors)만으로는 현대 축구의 하프스페이스(Half-space), 포켓(Pocket),
채널(Channel)을 활용하는 고도의 포지션 플레이(Juego de Posición)를
구현할 수 없다.^1^ 8명 이상의 다수 인원이 피치 위에서 서로 엉키지 않고
전술적 대형(Shape)을 유지하려면, 공간 그 자체를 정량적으로 평가하고
지배력을 계산하는 피치 제어 알고리즘이 필수적이다.

### 3.1 보로노이 다이어그램의 한계와 운동학적 피치 제어 모델

전통적인 스포츠 분석에서는 선수 간의 거리를 기준으로 공간을 분할하는
보로노이 다이어그램(Voronoi Diagram)이 널리 사용되어 왔다.^10^ 하지만
표준 보로노이 다이어그램은 피치 위의 모든 선수가 동일한 속도로 정지
상태에서 출발한다는 물리적 오류를 내포하고 있다.^10^ 실제 축구 경기에서
달리고 있는 공격수와 멈춰 있는 수비수는 같은 거리에 있더라도 특정 공간에
도달하는 데 걸리는 시간이 완전히 다르다.

따라서 로또축구단 매치 엔진은 선수의 현재 선속도(Velocity),
가속도(Acceleration), 최고 속도(Max Speed), 이동 방향(Orientation)을
모두 통합하여 계산하는 **운동학적 피치 컨트롤(Kinematic Pitch Control)**
모델을 도입해야 한다.^3^ 이는 William Spearman의 피치 컨트롤 모델을
근간으로 하며, 경기장의 특정 좌표 \$(x, y)\$에 아군 에이전트가 적군보다
먼저 도달하여 공을 통제할 확률 \$PC(t, x, y)\$를 산출하는 방식이다.^11^

그러나 22명의 에이전트 전원에 대해 경기장의 모든 무한한 픽셀 점에 도달
시간을 적분하여 계산하는 것은 유니티 메인 스레드에 치명적인 성능 저하를
초래한다.^3^ 따라서 실시간 게임 환경에 맞춘 근사화 알고리즘 설계가
수반되어야 한다.

### 3.2 그리드 기반 공간 분할 및 가우시안 영향력 맵

성능과 정확도의 균형을 맞추기 위해, 연속적인 3D 공간을 이산적인 2D
그리드(Grid)로 분할하는 방식을 제안한다.^14^

1.  **공간의 이산화 (Discretization):** 경기장 표면 전체를 1m x 1m 또는
    2m x 2m 크기의 셀(Cell)로 분할한 2차원 배열로 관리한다.

2.  **영향력 맵 (Influence Map) 생성:** 각 에이전트는 자신의 현재 위치를
    중심으로 가우시안 분포(Gaussian Distribution)를 따르는 공간 통제력을
    주변 그리드 셀에 방사한다.^14^

3.  **방향성 타원체 적용:** 선수가 이동 중일 경우, 단순한 원형이 아니라
    이동 방향(Velocity Vector) 축으로 가우시안 타원체를 길게 늘여,
    앞으로 달려나갈 공간에 대한 선제적 지배력을 가중 평가한다.^9^

4.  **K-D Tree를 이용한 탐색 최적화:** 특정 그리드 셀의 소유권을 계산할
    때 피치 위 22명을 모두 검사하는 \$O(n\^2)\$의 연산 복잡도를 막기
    위해, 에이전트의 위치 데이터를 K-D Tree 구조에 저장한다. 이를 통해
    해당 셀에 유의미한 영향을 미칠 수 있는 반경 내의 선수(Nearest
    Neighbors)들만 선별하여 영향력 합산 연산을 수행함으로써 연산 비용을
    기하급수적으로 낮춘다.^14^

### 3.3 AttackingTactics와 MarkingSystem을 통한 동적 위치 선정

실시간으로 갱신되는 피치 컨트롤 그리드 맵은 HybridAgentController의
내비게이션 모듈이 경로를 탐색할 때 밟아야 할 \'비용(Cost)\' 지도로
활용된다.

**공격 전개 시 (AttackingTactics):** 공을 소유하지 않은 아군 에이전트는
피치 컨트롤
지수(![](./images/media/image8.png){width="0.7561034558180227in"
height="0.248581583552056in"})가 아군에게 압도적으로 유리하면서도(예:
0.7 이상) 상대 골문에 가까운 최적의 노드(Sweet Spot)를 NavMesh 상에서
지속적으로 검색하여 침투 궤적을 그린다.^1^ 만약 감독의 전술 지침이
\'오버래핑(Overlapping)\'이고 에이전트의 역할이 윙백(WB)이라면,
알고리즘은 검색 영역을 피치 중앙이 아닌 터치라인 근처의 그리드로
제한하여 측면 공간 지배력이 높은 곳으로 이동 벡터를 생성한다.^1^ 반면
\'인버티드 윙백\' 역할이 부여된 선수는 측면이 아닌 중앙 미드필드 라인과
수비 라인 사이의 빈 공간(Pocket)을 우선 탐색하도록 검색 가중치가
조정된다.^1^

**수비 및 압박 시 (MarkingSystem):** 감독의 전술이 지역 수비(Zonal
Marking)로 설정되어 있다면, 수비수 AI는 포메이션의 기준점(Anchor
Point)을 중심으로 자신의 수비 구역 내에서 적군의 피치 컨트롤 점수가
비정상적으로 높아지는 핫스팟(Hotspot)을 찾아내어 선제적으로 이동함으로써
상대의 패스 길을 지운다.^1^ 대인 마크(Man-to-Man) 지침이 활성화된
경우에는 지정된 타겟 에이전트와의 거리를 지속적으로 좁히며 상대가
생성하는 가우시안 영향력 타원체를 상쇄시키는 데 주력한다.

### 3.4 동적 대형 유지와 테더링(Tethering) 물리 로직

11v11 환경에서는 선수 개별의 자유로운 이동과 팀 전체 대형(Shape) 유지
사이의 아슬아슬한 줄타기가 필요하다. 11명의 선수가 하나의 거대한
유기체처럼 움직이도록 하기 위해 **테더링(Tethering)** 로직이 물리 엔진
레벨에서 작용한다.^1^

공의 실시간 위치에 따라 포메이션 전체의 무게 중심(Anchor Point)이 선형
보간(Lerp) 방식으로 이동한다.^1^ 수비 상황으로 전환되면, 감독의 \'수비
라인 높이\' 및 \'압박 강도\' 지침에 따라 11명 에이전트들의 기준점 간 Z축
거리가 압축(Compactness)되어 블록을 좁힌다. 각 에이전트는 자신에게
할당된 기준점으로부터 일정 반경 이상 벗어나게 되면, 훅의 법칙(Hooke\'s
Law)에 기반한 스프링처럼 작용하는 스티어링 포스(Steering Force)가
Rigidbody.AddForce로 가해져 강제로 대형을 복원하도록 이끌린다.^1^ 이
물리적 테더링 힘과 공간 탐색을 통한 자율적 이동 힘이 벡터 합산되어
에이전트의 최종 이동 방향이 결정된다.

## 4. 전술 데이터 주도형 아키텍처(Tactics SO) 설계

전술의 종류와 지침의 조합은 수천 가지에 달할 수 있다. 이러한 방대한
분기문을 하드코딩(Hardcoding)이나 거대한 switch-case 문으로 처리하는
것은 소프트웨어 공학의 개방-폐쇄 원칙(OCP)에 정면으로 위배되며
유지보수를 불가능하게 만든다.^1^ 다양한 포메이션과 라이선스 등급에 따른
전술 해금(Unlock) 기능을 유연하게 관리하고, 비개발자인 게임 디자이너가
유니티 에디터 인스펙터(Inspector) 상에서 실시간으로 밸런스를 조정할 수
있도록 **ScriptableObject(SO)** 기반의 모듈화된 아키텍처를 구축해야
한다.^16^

### 4.1 ScriptableObject 클래스 계층 구조 설계

전술 데이터는 재사용성을 극대화하기 위해 독립적인 책임을 가지는 세 가지
계층의 ScriptableObject로 분리되어 설계된다.

**1) FormationData (포메이션 기하학 모델):**

11명의 에이전트가 피치 위에 배치될 기본 기준점(Anchor Point)의 공간
정보를 정의한다. 실제 경기장 크기가 달라져도 대응할 수 있도록 절대
좌표가 아닌 -1.0 \~ 1.0 사이의 정규화된 2D 벡터로 저장된다.

  -----------------------------------------------------------------------
  **필드 명 (Field)**     **데이터 타입 (Type)**  **역할 및 설명
                                                  (Description)**
  ----------------------- ----------------------- -----------------------
  FormationName           string                  포메이션의 고유 명칭
                                                  (예: \"4-2-3-1\",
                                                  \"3-5-2\")

  BasePositions           Vector2                 공격 전개 시 기준이
                                                  되는 11명 선수의 X, Y
                                                  상대 좌표

  DefensiveOffsets        Vector2                 수비 블록 형성 시
                                                  적용되는 수비 복귀
                                                  오프셋 (간격 압축 비율)

  AllowedRoles            List\<PlayerRoleSO\>    각 포지션 슬롯에서 선택
                                                  가능한 역할의 제한 목록
  -----------------------------------------------------------------------

**2) PlayerRoleSO (포지션 역할 정의):**

개별 선수의 오프더볼 위치 선정 및 유틸리티 점수 가중치에 영향을 주는
구체적인 역할(예: 인버티드 윙백, 딥라잉 플레이메이커)을 정의한다.

  -----------------------------------------------------------------------
  **필드 명 (Field)**     **데이터 타입 (Type)**  **역할 및 설명
                                                  (Description)**
  ----------------------- ----------------------- -----------------------
  RoleName                string                  역할 명칭 (예:
                                                  \"Inverted Wingback\",
                                                  \"Sweeper Keeper\")

  Phase                   TacticalPhase           해당 역할이 활성화되는
                                                  국면 (예: 빌드업, 전개,
                                                  마무리) ^1^

  UtilityModifiers        Dictionary\<Action,     해당 역할을 맡았을 때
                          float\>                 특정 행동(예: 크로스)의
                                                  점수에 곱해지는 보정치

  TargetSpace             SpaceType               오프더볼 상황에서
                                                  우선적으로 침투해야 할
                                                  전술 공간 (예: Pocket,
                                                  Channel)
  -----------------------------------------------------------------------

**3) TacticsConfig (팀 단위 전술 컨테이너):**

감독이 지시하는 글로벌 팀 지침과 선택된 포메이션, 선수별 역할을
총망라하는 최상위 설정 데이터이다.

  -----------------------------------------------------------------------
  **필드 명 (Field)**     **데이터 타입 (Type)**  **역할 및 설명
                                                  (Description)**
  ----------------------- ----------------------- -----------------------
  Mentality               TeamMentality           극수비부터 극공격까지의
                                                  팀 성향 (에이전트
                                                  베이스 전진성 점수
                                                  보정)

  Tempo                   float (0\~100)          팀 전체의 의사결정 속도
                                                  조절 및 패스 가중치
                                                  상승폭 결정

  PassingDirectness       float (0\~100)          패스 대상 탐색 시
                                                  Distance 가중치 보정
                                                  (수치가 높을수록 롱패스
                                                  선호)

  PressingIntensity       float (0\~100)          수비 시 상대를 향한
                                                  스티어링 포스의 강도 및
                                                  압박 상태 진입 임계값

  SelectedFormation       FormationData           팀이 현재 사용 중인
                                                  포메이션 SO 참조
  -----------------------------------------------------------------------

### 4.2 감독 라이선스 기반 전술 해금(Unlock) 인터페이스 구조

로또축구단의 전술 시스템은 유저가 보유한 감독 라이선스 등급(무 라이선스,
C, B, A, Pro)에 따라 사용할 수 있는 포메이션, 세부 전술 지침, 포지션
역할이 엄격하게 제한된다.^1^ 예를 들어 무 라이선스 감독은 442, 433
포메이션과 기본 역할만 사용할 수 있으며, \'후방 빌드업\'이나 \'미들
블록\'과 같은 국면(Phase) 세분화 지침은 B 라이선스 이상에서만
해금된다.^1^

이러한 해금 시스템을 코드 레벨에서 유연하게 통제하기 위해 객체 지향의
데코레이터 패턴(Decorator Pattern)과 ITacticalUnlockable 인터페이스를
적용한다.^1^

> C#

public enum LicenseLevel { None, C, B, A, Pro }\
\
public interface ITacticalUnlockable\
{\
LicenseLevel RequiredLicense { get; }\
bool IsUnlocked(LicenseLevel currentManagerLicense);\
}\
\
// 개별 역할에 라이선스 제한을 적용하는 예시\
\
public class PlayerRoleSO : ScriptableObject, ITacticalUnlockable\
{\
public string RoleName;\
private LicenseLevel \_requiredLicense;\
\
public LicenseLevel RequiredLicense =\> \_requiredLicense;\
\
public bool IsUnlocked(LicenseLevel currentManagerLicense)\
{\
return currentManagerLicense \>= \_requiredLicense;\
}\
}

매치 시작 전, 팀의 매니저 시스템은 TacticsConfig를 순회하며 현재 감독의
라이선스와 각 전술 요소의 RequiredLicense를 비교한다. 만약 무 라이선스
감독이 \'인버티드 윙백(B 라이선스 요구)\' 역할이 강제로 포함된 SO
데이터를 로드하려 한다면, 시스템은 IsUnlocked 메서드의 false 반환을
감지하여 해당 역할을 가장 하위 호환되는 기본 역할(예: 일반 풀백)로
실시간 강등(Fallback)시킨다.

더불어, DecisionEvaluator가 에이전트의 유틸리티 점수를 평가할 때 이
라이선스 객체를 의존성 주입(Dependency Injection) 받는다. 등급이
낮을수록 복합적인 역할을 지시하더라도 에이전트가 해당 전술 공간(Pocket
등)을 인지하는 가중치 팩터가 감소하게 되어, 감독의 역량 자체가 실제 AI
공간 지능의 한계를 규정하는 \*\*\'전술적 필터(Tactical Filter)\'\*\*로
완벽히 작동하게 된다.^1^

## 5. 방어적 코딩 및 대규모 에이전트 성능 최적화 가이드

8명에서 11명으로 인원이 확장되면 양 팀 도합 22명의 에이전트가 피치
위에서 매 프레임 수십 개의 행동 후보군(Shoot, Pass, Dribble)에 대해
내적, 거리 연산, 상대와의 밀집도 계산, 시야 확인용 물리
레이캐스트(Raycast), 그리고 앞서 언급한 그리드 기반의 피치 컨트롤 수학
연산을 수행해야 한다. 이러한 연산 부하를 유니티의 메인 스레드(Main
Thread)에서 동기적으로 처리하게 되면 프레임 드랍(Frame Drop)과 심각한
CPU 병목 현상(Bottleneck)이 발생하여 물리 시뮬레이션의 정합성이
훼손된다.^1^ 이를 극복하기 위한 다각도의 최적화 및 방어적 코딩 전략이
필수적이다.

### 5.1 타임 슬라이싱(Time-Slicing)과 인지 지연 기반 프레임 분산

모든 에이전트가 동시에 DecisionEvaluator.MakeDecision()을 호출하여
무거운 연산을 실행하는 것을 막아야 한다. 로또축구단 매치 엔진의 핵심인
\'인지 지연(Thinking Interval)\' 로직을 확장하여 연산을 여러 프레임에
걸쳐 분산시키는 **타임 슬라이싱(Time-Slicing)** 기법을 도입한다.^1^

- **동적 예산 메커니즘 (Dynamic Budgeting):** 유니티의
  QualitySettings.asyncUploadTimeSlice 개념을 차용하여, 한 프레임 내에서
  AI 연산에 할당할 수 있는 최대 CPU 시간 예산(예: 2ms)을 설정한다.^21^

- **우선순위 큐 (Priority Queue) 처리:** 22명의 에이전트를 행동 갱신이
  필요한 순서대로 큐에 담아 업데이트 루프를 돈다. 예산이 소진되면 나머지
  에이전트의 의사결정 연산은 다음 프레임으로 이월(Yield)된다.^19^

- **능력치 기반 슬라이싱:** 여기서 선수의 Mental 스탯(판단력)은 슬라이싱
  큐에서의 \'우선순위(Priority)\' 지표로 작동한다. 스탯이 높은 선수는
  큐의 앞단에 배치되거나 갱신 주기가 짧게 설정되어 더 자주 상황을
  판단하지만, 스탯이 낮은 선수는 예산 초과로 인한 프레임 지연을 겪어
  반응 속도가 느려진다. 이는 성능 최적화를 위한 기술적 기법이 \'지능이
  낮은 선수의 인지 지연 현상\'이라는 게임적 현실성으로 승화되는 훌륭한
  설계다.^1^

### 5.2 유니티 잡 시스템(Job System)과 데이터 지향 설계(DOTS) 대비

가장 연산 비용이 비싼 1) 피치 컨트롤 그리드 단위 가우시안 영향력 계산,
2) 22명 에이전트 간의 상호 거리 및 방사형 밀집도 분석, 3) 동료에게
이르는 패스 경로의 시야선 확보 여부(Raycast) 계산은 메인 스레드에서
완전히 격리되어야 한다.

- **IJobParallelFor 및 Burst Compiler 활용:** 밀집도나 거리 연산 로직을
  class 기반의 객체 참조에서 분리하여, Blittable 형태의 struct와
  NativeArray 기반으로 재작성한다.^1^ 이를 유니티의 C# Job
  System(IJobParallelFor)에 오프로드(Offload)하여 다중 코어(Worker
  Threads)에서 병렬로 연산하게 만든다.^22^ 버스트 컴파일러(Burst
  Compiler)를 적용하면 고도의 수학적 벡터 연산이 SIMD 명령어 수준으로
  최적화되어 압도적인 성능 향상을 이끌어낼 수 있다.

- **지연 수집(Delayed Gathering) 비동기 패턴:** 메인 스레드에서
  잡(Job)을 예약(Schedule)한 직후 곧바로 Complete()를 호출하여 대기하면
  메인 스레드가 정지(Stall)하는 역효과가 난다.^19^ 따라서 프레임
  ![](./images/media/image6.png){width="0.18391841644794402in"
  height="0.24522528433945756in"}의 렌더링 끝단에서 레이캐스트나 거리
  연산 잡을 예약해두고, 다음 프레임인
  ![](./images/media/image17.png){width="0.53125in" height="0.25in"}의
  업데이트 시작 시점에 결과를 수집(Gather)하여 DecisionEvaluator에
  전달하는 비동기 패턴을 적용한다.^19^ 이러한 1\~2 프레임의 연산 지연은
  선수가 주변 상황을 스캐닝한 후 찰나의 지연을 거쳐 신체를 움직이는
  현실적인 인간의 반응 속도(0.1초 내외)와 완벽히 부합하므로 시뮬레이션의
  사실성을 전혀 해치지 않는다.

### 5.3 비동기 워크플로우(Awaitable) 및 방어적 코딩 (SOLID, KISS)

- **Awaitable 기반 비동기 설계:** 유니티 6에서 도입된 Awaitable을
  활용하여 대기 상태가 필요한 전술 연산(예: 세트피스 상황에서의 진형
  배치 완료 대기 등)을 코루틴(Coroutine)의 가비지 컬렉션(GC) 할당 없이
  비동기적으로 처리한다.^23^ 이는 메모리 릭(Memory Leak)을 방지하고
  코드의 가독성을 높인다.

- **KISS (Keep It Simple, Stupid) 및 방어적 코딩:** RootState_Attacking
  등 상태 클래스 내부에 방대하게 하드코딩되었던 패스, 슛 점수 판별
  로직을 FootballPhysicsUtils 정적 클래스와 DecisionEvaluator 내부의
  단위 메서드로 완전히 분해한다.^1^ 특히 슈팅 퀄리티 공식이나 피치
  컨트롤 계산 시 발생하는 잦은 나눗셈 연산에서 분모가 0이 되어 매치
  엔진이 크래시되는 DivideByZeroException을 원천 차단하기 위해
  Mathf.Max(Distance, 0.1f)와 같은 안전 장치를 모든 수학 수식에 철저히
  적용한다.^1^

- **단일 책임 원칙 (SRP) 기반 책임 격리:** 11v11의 혼전 상황에서는
  22개의 복잡한 물리 콜라이더가 얽혀
  몸싸움(![](./images/media/image15.png){width="0.45182305336832895in"
  height="0.2521806649168854in"}) 공식을 실행하게 된다.^1^ 에이전트의
  경로 생성은 철저히 두뇌인 NavMeshAgent가, 캐릭터의 공간 이동 및 충돌
  처리는 신체인 Rigidbody가 담당해야 한다.^1^ 중앙의
  HybridAgentController는 이 두 컴포넌트 사이에서 다음 경로 벡터를
  물리적 힘(Force)으로 변환해 전달하는 인터페이스 역할만을 수행하도록
  책임을 명확히 격리해야만, 대규모 충돌 상황에서도 물리 엔진이
  안정적으로 스탯 기반의 보정을 수행할 수 있다.^1^

## 6. 결론

\'로또축구단\'의 매치 엔진을 8v8에서 정규 11v11 규격으로 스케일업하는
작업은 단순한 그래픽 개체 수의 확장이 아니라, 복잡계(Complex System)에
대응하기 위한 근본적인 아키텍처의 재설계 과정이다.

본 보고서에서 제시한 아키텍처는 감독의 추상적이고 언어적인 \*\*전술
지침(Tactical Instructions)\*\*을 동적인 수학적 \*\*유틸리티
가중치(Utility Weights)\*\*로 치환하여 에이전트의 두뇌에 주입한다.
동시에 기존 보로노이 다이어그램의 한계를 넘어서는 \*\*운동학적 피치
컨트롤(Kinematic Pitch Control)\*\*과 **K-D Tree 기반 공간 분할
알고리즘**을 통해, 22명의 선수가 포켓과 채널 등 현대 축구의 핵심 공간을
인지하고 3D 피치를 유기적으로 지배하도록 이끈다.

더 나아가 이 방대한 전술과 포메이션 변수를 **ScriptableObject 기반의
데이터 주도형 구조**로 캡슐화하여 확장성과 디자이너의 편집 용이성을
담보하였다. 인원 증가에 따른 기하급수적인 연산 부하는 선수의
능력치(Mental Stats)와 결합된 **타임 슬라이싱(Time-Slicing)**,
\*\*유니티 잡 시스템(Job System)\*\*을 활용한 비동기 지연 수집 패턴을
통해 성능 최적화라는 기술적 과제를 \'선수의 인지 지연\'이라는
시뮬레이션의 사실성으로 우아하게 승화시켰다.

이러한 철저한 모듈화, 방어적 코딩, 그리고 통계와 물리 연산의 융합을
통해, 에이전트의 개별 능력치와 감독의 전술이 3D 물리 환경(PhysX) 속에서
실시간으로 얽히며 예측 불가능하지만 통계적으로 타당한 결과를 만들어내는
진정한 의미의 \*\*\'통계적 결정론 기반 True 3D 시뮬레이션\'\*\*이
성공적으로 구현될 것이다.

#### 참고 자료

1.  \# \[로또축구단\] 매치 엔진 전술 시스템 확장 (8v8 - 11.txt

2.  Quantifying Pitch Control in Soccer - Math projects, 2월 22, 2026에
    액세스,
    [[https://math-projects.elte.hu/media/works/388/report/Project-Work-Balazs_pACbvVD.pdf]{.underline}](https://math-projects.elte.hu/media/works/388/report/Project-Work-Balazs_pACbvVD.pdf)

3.  A New Metric for Pitch Control based on an Intuitive Motion Model,
    2월 22, 2026에 액세스,
    [[https://www.sfu.ca/\~tswartz/papers/pitch_control.pdf]{.underline}](https://www.sfu.ca/~tswartz/papers/pitch_control.pdf)

4.  An introduction to Utility AI - The Shaggy Dev, 2월 22, 2026에
    액세스,
    [[https://shaggydev.com/2023/04/19/utility-ai/]{.underline}](https://shaggydev.com/2023/04/19/utility-ai/)

5.  An Introduction to Utility Theory - Game AI Pro, 2월 22, 2026에
    액세스,
    [[http://www.gameaipro.com/GameAIPro/GameAIPro_Chapter09_An_Introduction_to_Utility_Theory.pdf]{.underline}](http://www.gameaipro.com/GameAIPro/GameAIPro_Chapter09_An_Introduction_to_Utility_Theory.pdf)

6.  Tactical Game Analysis AI Agent for Match Strategy in Sports, 2월
    22, 2026에 액세스,
    [[https://digiqt.com/ai-agent/sports/match-strategy/tactical-game-analysis-ai-agent-for-match-strategy-in-sports/]{.underline}](https://digiqt.com/ai-agent/sports/match-strategy/tactical-game-analysis-ai-agent-for-match-strategy-in-sports/)

7.  Changing the Tactical Game: Introducing Team Instructions! \| by
    Lucas - MFL ⚽️, 2월 22, 2026에 액세스,
    [[https://blog.playmfl.com/changing-the-tactical-game-introducing-team-instructions-573908ad8425]{.underline}](https://blog.playmfl.com/changing-the-tactical-game-introducing-team-instructions-573908ad8425)

8.  Can Semantic Methods Enhance Team Sports Tactics? A Methodology for
    Football with Broader Applications - arXiv.org, 2월 22, 2026에
    액세스,
    [[https://arxiv.org/html/2601.00421v1]{.underline}](https://arxiv.org/html/2601.00421v1)

9.  Visualizing positioning and player decisions: the innovation of
    Dynamic Pitch Control, 2월 22, 2026에 액세스,
    [[https://www.footovision.com/visualizing-positioning-and-player-decisions-the-innovation-of-dynamic-pitch-control]{.underline}](https://www.footovision.com/visualizing-positioning-and-player-decisions-the-innovation-of-dynamic-pitch-control)

10. (PDF) The Voronoi Diagram in Soccer Revisited - ResearchGate, 2월
    22, 2026에 액세스,
    [[https://www.researchgate.net/publication/364118650_The_Voronoi_Diagram_in_Soccer_Revisited]{.underline}](https://www.researchgate.net/publication/364118650_The_Voronoi_Diagram_in_Soccer_Revisited)

11. Exploring the application of soccer mathematical models to game
    generation on a simulated environment - sports tomorrow congress,
    2월 22, 2026에 액세스,
    [[https://sportstomorrow.fcbarcelona.com/wp-content/uploads/2020/11/Exploring_the_application_of_soccer_mathematical_models_to_game_generation_on_a_simulated_environment.pdf]{.underline}](https://sportstomorrow.fcbarcelona.com/wp-content/uploads/2020/11/Exploring_the_application_of_soccer_mathematical_models_to_game_generation_on_a_simulated_environment.pdf)

12. Modeling and Analyzing Pass Values in Football - Tilburg University,
    2월 22, 2026에 액세스,
    [[http://arno.uvt.nl/show.cgi?fid=170869]{.underline}](http://arno.uvt.nl/show.cgi?fid=170869)

13. AI on the Pitch: Football Analysis with Machine Learning and
    Computer Vision - Al Akhawayn University, 2월 22, 2026에 액세스,
    [[https://cdn.aui.ma/sse-capstone-repository/pdf/fall-2024/mehdibougaa97647_5193_3512890_Capstone%20Report.pdf]{.underline}](https://cdn.aui.ma/sse-capstone-repository/pdf/fall-2024/mehdibougaa97647_5193_3512890_Capstone%20Report.pdf)

14. Space Occupation --- DataBallPy Documentation, 2월 22, 2026에
    액세스,
    [[https://databallpy.readthedocs.io/en/v0.5.0/features/space_occupation.html]{.underline}](https://databallpy.readthedocs.io/en/v0.5.0/features/space_occupation.html)

15. Create a Soccer Game in Godot! (14/24: Steering behaviors and AI) -
    YouTube, 2월 22, 2026에 액세스,
    [[https://www.youtube.com/watch?v=4_J_rYPteXg]{.underline}](https://www.youtube.com/watch?v=4_J_rYPteXg)

16. Separate Game Data and Logic with ScriptableObjects - Unity, 2월 22,
    2026에 액세스,
    [[https://unity.com/how-to/separate-game-data-logic-scriptable-objects]{.underline}](https://unity.com/how-to/separate-game-data-logic-scriptable-objects)

17. Architect your code for efficient changes and debugging with
    ScriptableObjects \| Unity, 2월 22, 2026에 액세스,
    [[https://unity.com/how-to/architect-game-code-scriptable-objects]{.underline}](https://unity.com/how-to/architect-game-code-scriptable-objects)

18. Design choices for integrating license handling - Stack Overflow,
    2월 22, 2026에 액세스,
    [[https://stackoverflow.com/questions/5616649/design-choices-for-integrating-license-handling]{.underline}](https://stackoverflow.com/questions/5616649/design-choices-for-integrating-license-handling)

19. Game Programming: Time Slicing \| Ming-Lun \"Allen\" Chou \| 周明倫,
    2월 22, 2026에 액세스,
    [[https://allenchou.net/2021/05/time-slicing/]{.underline}](https://allenchou.net/2021/05/time-slicing/)

20. Scripting API: QualitySettings.asyncUploadTimeSlice - Unity -
    Manual, 2월 22, 2026에 액세스,
    [[https://docs.unity3d.com/6000.3/Documentation/ScriptReference/QualitySettings-asyncUploadTimeSlice.html]{.underline}](https://docs.unity3d.com/6000.3/Documentation/ScriptReference/QualitySettings-asyncUploadTimeSlice.html)

21. Async mesh upload does not respect the time slice limit, causing
    stuttering - Reddit, 2월 22, 2026에 액세스,
    [[https://www.reddit.com/r/Unity3D/comments/10r4u1o/async_mesh_upload_does_not_respect_the_time_slice/]{.underline}](https://www.reddit.com/r/Unity3D/comments/10r4u1o/async_mesh_upload_does_not_respect_the_time_slice/)

22. Improving job system performance scaling in 2022.2 -- part 2:
    Overhead - Unity, 2월 22, 2026에 액세스,
    [[https://unity.com/blog/engine-platform/improving-job-system-performance-2022-2-part-2]{.underline}](https://unity.com/blog/engine-platform/improving-job-system-performance-2022-2-part-2)

23. Async in Unity: Main Thread First, Multithread When Needed -
    YouTube, 2월 22, 2026에 액세스,
    [[https://www.youtube.com/watch?v=GSjBWnfBzb0]{.underline}](https://www.youtube.com/watch?v=GSjBWnfBzb0)
