# [Day 6] 물리 엔진 버그 수정 및 수비 AI 강화

## 📅 기본 정보
- **날짜**: 2026-02-02 (월요일)
- **개발 일차**: 6일차
- **작업 카테고리**: 매치엔진 / AI / 물리

## 🛠️ 오늘의 구현 (Implementation)
> 공의 멈춤 현상 수정과 수비진의 지능형 마킹 시스템 구현.

- [x] **공 멈춤/끊김(Stuttering) 현상 수정**:
    - `BallAerodynamics`에 `ResetAerodynamics()` 추가: 공이 튀거나 킥을 할 때 이전 마그누스 힘이 남아있어 "유령 힘"이 작용하는 문제 해결.
    - `HybridAgentController`에 **킥 직후 충돌 무시(0.5초)** 로직 추가: 골키퍼가 클리어런스 직후 자신의 발에 공이 닿아 '세이브'로 판정하고, 드리블 어시스트가 공을 멈춰 세우는 문제 해결.
    - 급격한 방향 전환 시(`>90도`) 마그누스 힘을 즉시 갱신하는 'Snap Force' 로직 적용.

- [x] **지능형 수비 AI 시스템 (Dynamic Defense)**:
    - **거리별 압박 강도(Pressure Intensity)** 세분화:
        - Safe Zone: 2.5m (Contain)
        - Danger Zone: 1.5m (Close Down)
        - Critical Zone: 0.5m (Press)
    - **슛 블로킹(Shot Blocking)**: 슈팅 궤적 예측 및 경로 차단 로직 구현.
    - **존 디펜스 강화**: 공을 무작정 쫓지 않고 자신의 지역(Zone)을 지키며 결정적일 때만 개입.
    - **스탠드 그라운드(Stand Ground)**: 수비수가 좋은 위치(길목)를 선점했을 경우, 더 이상 뒤로 물러나지 않고 제자리에서 대기하다가 다가오면 태클(Tackle Trap) 시도. (Logic Fix: 수비 진영에서 작동하지 않던 오류 수정)
    - **포메이션 확장**: `CDM`(수비형 미드필더), `CAM`(공격형 미드필더) 포지션 추가 및 기본 오프셋 설정 완료.
    - **포메이션 캡처 툴**: 씬(Scene)에 배치된 선수들의 위치를 그대로 포메이션 데이터로 저장하는 에디터 툴(`Tools/Lotto/Capture ...`) 추가. (수동 입력 실수 방지)
    - **킥오프 위치 수정**: 킥오프 시 강제로 포메이션을 압축하던 로직 제거. 설정한 포메이션 그대로 배치되되, 규칙(하프라인, 센터서클 침범 금지)만 적용됨.
    - **경기장 벽 생성 툴**: 공/선수 이탈 방지를 위한 투명 벽 생성 기능(`Tools/Lotto/Create Field Walls`) 추가.

*기술적 메모*: 공의 회전력(Angular Velocity)과 이동 방향(Velocity)이 충돌 시 즉시 리셋되지 않아 발생하던 물리적 기행을 `OnCollisionEnter`에서 강제 리셋하여 해결함.

## 🎥 영상 소스 & 연출 (For YouTube)
1. **메인 샷**: 골키퍼의 시원한 클리어런스 (더 이상 발 앞에 멈추지 않고 쭉 뻗어나가는 궤적).
2. **비교 샷**: 수정 전(공이 공중에서 멈칫거림) vs 수정 후(부드러운 포물선).
3. **강조할 점**: "이제 공은 물리 법칙을 거스르지 않습니다." (Defenders now actively block shots with their bodies).

## 🐛 이슈 및 버그 (Issues)
- **해결됨**: 공이 스스로 방향을 바꾸거나 멈추는 현상 (Physics Reset / Kick Collision Ignore).
- **해결됨**: 수비수가 공격수에게 너무 쉽게 공간을 내주는 문제 (지능형 수비 AI 구현 완료).
- **진행 중**: 공격수들이 경기 시작 직후 공을 무시하는 문제 (Phase 10 예정).
